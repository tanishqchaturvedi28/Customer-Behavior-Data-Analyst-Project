 --Q1. What is the total revenue generated by male vs. female customers?
 select gender, SUM(purchase_amount) as revenue from customer group by gender;
+--------+---------+
| gender | revenue |
+--------+---------+
| Female |   75191 |
| Male   |  157890 |
+--------+---------+


 --Q2. Which customers used a discount but still spent more than the average purchase amount?
      select customer_id, purchase_amount
    -> from customer
    -> where discount_applied = 'Yes' and purchase_amount >= (select AVG(purchase_amount) from customer);
+-------------+-----------------+
| customer_id | purchase_amount |
+-------------+-----------------+
|           2 |              64 |
|           3 |              73 |
|           4 |              90 |
|           7 |              85 |
|           9 |              97 |
|          12 |              68 |
|          13 |              72 |
|          16 |              81 |
|          20 |              90 |
|          22 |              62 |
|          24 |              88 |
|          29 |              94 |
|          32 |              79 |
|          33 |              67 |
|          35 |              91 |
|          37 |              69 |
|          40 |              60 |
|          41 |              76 |
|          43 |             100 |
|          44 |              69 |
|          55 |              94 |
|          57 |              73 |
|          58 |              64 |
|          60 |              79 |
|          62 |              68 |
|          64 |              79 |
|          65 |              83 |
|          67 |              94 |
|          70 |              70 |
|          74 |              85 |
|          76 |              85 |
|          79 |              91 |
|          80 |              96 |
|          81 |              72 |
|          82 |              96 |
|          86 |              95 |
|          90 |              83 |
|          92 |              99 |
|          93 |              87 |
|          94 |              62 |
|          95 |              76 |
|          96 |             100 |
|          97 |              73 |
|          98 |              92 |
|          99 |              67 |
|         101 |              98 |
|         102 |              85 |
|         103 |              67 |
|         104 |              89 |
|         106 |              96 |
|         108 |              67 |
|         109 |              79 |
|         110 |              85 |
|         112 |              75 |
|         113 |              65 |
|         115 |              95 |
|         116 |              94 |
|         117 |              86 |
|         120 |              76 |
|         121 |              84 |
|         122 |              72 |
|         124 |              89 |
|         125 |              86 |
|         128 |              89 |
|         130 |              67 |
|         134 |              65 |
|         135 |              94 |
|         136 |              81 |
|         137 |              86 |
|         140 |              95 |
|         146 |              95 |
|         148 |              64 |
|         149 |              90 |
|         150 |              76 |
|         151 |              96 |
|         153 |              85 |
|         155 |              98 |
|         156 |              77 |
|         158 |              68 |
|         159 |              73 |
|         163 |              74 |
|         164 |              67 |
|         165 |              65 |
|         166 |              60 |
|         169 |              80 |
|         173 |              67 |
|         176 |              86 |
|         177 |              81 |
|         181 |              81 |
|         182 |              61 |
|         183 |              96 |
|         188 |              94 |
|         190 |              82 |
|         191 |              70 |
|         192 |              76 |
|         194 |             100 |
|         195 |              94 |
|         197 |              88 |
|         198 |              78 |
|         200 |              73 |
|         201 |              61 |
|         205 |             100 |
|         206 |              64 |
|         208 |              91 |
|         210 |              97 |
|         212 |              92 |
|         213 |              84 |
|         214 |              93 |
|         216 |              64 |
|         217 |              61 |
|         220 |              88 |
|         222 |              68 |
|         223 |              94 |
|         225 |              83 |
|         227 |              74 |
|         228 |              90 |
|         229 |              79 |
|         231 |              88 |
|         234 |              83 |
|         236 |              89 |
|         237 |              68 |
|         238 |              90 |
|         242 |              88 |
|         243 |              85 |
|         244 |             100 |
|         247 |              86 |
|         248 |              66 |
|         249 |             100 |
|         254 |              73 |
|         259 |              74 |
|         262 |              77 |
|         265 |              78 |
|         267 |              75 |
|         272 |              69 |
|         276 |              85 |
|         279 |              95 |
|         280 |              69 |
|         281 |              69 |
|         282 |              61 |
|         283 |              94 |
|         289 |              62 |
|         290 |              85 |
|         293 |              99 |
|         297 |              74 |
|         300 |              80 |
|         301 |              98 |
|         302 |              95 |
|         304 |              60 |
|         305 |              84 |
|         311 |              85 |
|         313 |              89 |
|         314 |              77 |
|         318 |              82 |
|         319 |              67 |
|         320 |              74 |
|         321 |              72 |
|         323 |              95 |
|         324 |              78 |
|         325 |              82 |
|         326 |              70 |
|         332 |              98 |
|         333 |              86 |
|         334 |              64 |
|         336 |              85 |
|         337 |              81 |
|         339 |              79 |
|         345 |              71 |
|         350 |              87 |
|         351 |              68 |
|         352 |              90 |
|         353 |              71 |
|         354 |              64 |
|         355 |              76 |
|         357 |              80 |
|         360 |              74 |
|         362 |              96 |
|         363 |              64 |
|         364 |              88 |
|         365 |              88 |
|         366 |              88 |
|         372 |              83 |
|         373 |              85 |
|         375 |              78 |
|         379 |              62 |
|         381 |              69 |
|         383 |              76 |
|         384 |              77 |
|         386 |              93 |
|         388 |              93 |
|         389 |              82 |
|         391 |              71 |
|         392 |              86 |
|         393 |              82 |
|         394 |              65 |
|         396 |              65 |
|         397 |              88 |
|         399 |              67 |
|         401 |              66 |
|         402 |              91 |
|         403 |              78 |
|         405 |              93 |
|         406 |              74 |
|         408 |              76 |
|         409 |              66 |
|         413 |              74 |
|         414 |              99 |
|         415 |              88 |
|         418 |              81 |
|         419 |              73 |
|         420 |              91 |
|         426 |              87 |
|         427 |              71 |
|         428 |              91 |
|         429 |              64 |
|         430 |              94 |
|         432 |              76 |
|         433 |              86 |
|         434 |              92 |
|         441 |              89 |
|         442 |              81 |
|         443 |              69 |
|         444 |              67 |
|         447 |              74 |
|         448 |              82 |
|         455 |              97 |
|         456 |             100 |
|         457 |              96 |
|         458 |              99 |
|         459 |              91 |
|         461 |              65 |
|         462 |              93 |
|         463 |              81 |
|         464 |              81 |
|         466 |              88 |
|         471 |              63 |
|         472 |              72 |
|         475 |              76 |
|         476 |              66 |
|         477 |              90 |
|         480 |              84 |
|         481 |              88 |
|         482 |              88 |
|         484 |              73 |
|         485 |              73 |
|         487 |              63 |
|         488 |              68 |
|         490 |              85 |
|         492 |              69 |
|         493 |              62 |
|         495 |              68 |
|         497 |              63 |
|         499 |              78 |
|         500 |              99 |
|         506 |              63 |
|         510 |              80 |
|         511 |              87 |
|         514 |              65 |
|         515 |              62 |
|         516 |              67 |
|         519 |             100 |
|         521 |              84 |
|         523 |              88 |
|         529 |              88 |
|         530 |              84 |
|         533 |              76 |
|         534 |              60 |
|         535 |              72 |
|         537 |              84 |
|         543 |              79 |
|         544 |              98 |
|         545 |              64 |
|         547 |              74 |
|         549 |              64 |
|         551 |              62 |
|         552 |              78 |
|         553 |              94 |
|         557 |              90 |
|         558 |              60 |
|         559 |              77 |
|         562 |              65 |
|         563 |              62 |
|         564 |              99 |
|         567 |              93 |
|         569 |              88 |
|         571 |              99 |
|         572 |              76 |
|         573 |              97 |
|         574 |              68 |
|         575 |              79 |
|         576 |              86 |
|         577 |              68 |
|         579 |              90 |
|         581 |              80 |
|         582 |             100 |
|         583 |              77 |
|         584 |              78 |
|         585 |              94 |
|         588 |              86 |
|         589 |              60 |
|         590 |              70 |
|         595 |              83 |
|         596 |              77 |
|         598 |              69 |
|         599 |              66 |
|         601 |              63 |
|         605 |              92 |
|         607 |              90 |
|         611 |              72 |
|         615 |              85 |
|         616 |             100 |
|         617 |              72 |
|         619 |              94 |
|         621 |              89 |
|         623 |              63 |
|         624 |              70 |
|         625 |              87 |
|         626 |              79 |
|         627 |              79 |
|         629 |              85 |
|         630 |              90 |
|         631 |              94 |
|         632 |              68 |
|         635 |              60 |
|         641 |              88 |
|         642 |              78 |
|         645 |              93 |
|         648 |              70 |
|         650 |              93 |
|         654 |              68 |
|         658 |              80 |
|         661 |              79 |
|         662 |              68 |
|         663 |              98 |
|         664 |              83 |
|         665 |              83 |
|         668 |              76 |
|         669 |              85 |
|         670 |              89 |
|         674 |              66 |
|         676 |              86 |
|         677 |              60 |
|         678 |              62 |
|         679 |              74 |
|         680 |              95 |
|         685 |              82 |
|         686 |              71 |
|         690 |              91 |
|         691 |              68 |
|         693 |              95 |
|         696 |              67 |
|         698 |              63 |
|         701 |              79 |
|         702 |              90 |
|         703 |              71 |
|         704 |              87 |
|         705 |              66 |
|         706 |              90 |
|         710 |              79 |
|         711 |              91 |
|         712 |              60 |
|         713 |              81 |
|         714 |              90 |
|         715 |              70 |
|         716 |              63 |
|         718 |              90 |
|         721 |              62 |
|         725 |              79 |
|         726 |              61 |
|         727 |              78 |
|         728 |              97 |
|         729 |              78 |
|         735 |              69 |
|         741 |              69 |
|         742 |              79 |
|         744 |              84 |
|         745 |              66 |
|         746 |              92 |
|         748 |              74 |
|         750 |              71 |
|         751 |              95 |
|         752 |              72 |
|         753 |              85 |
|         757 |              99 |
|         759 |              71 |
|         762 |              91 |
|         766 |              99 |
|         768 |              77 |
|         769 |              95 |
|         770 |             100 |
|         772 |              68 |
|         774 |              84 |
|         777 |              60 |
|         780 |              94 |
|         784 |              65 |
|         785 |              72 |
|         786 |              62 |
|         788 |              85 |
|         790 |              84 |
|         797 |              78 |
|         798 |              82 |
|         808 |              89 |
|         809 |              96 |
|         810 |              81 |
|         811 |              83 |
|         815 |              62 |
|         816 |              84 |
|         819 |              91 |
|         825 |              94 |
|         826 |              94 |
|         827 |              94 |
|         829 |              62 |
|         831 |              76 |
|         832 |              63 |
|         833 |              80 |
|         834 |              68 |
|         835 |              89 |
|         837 |              90 |
|         842 |              88 |
|         843 |              87 |
|         844 |              80 |
|         847 |              72 |
|         849 |              73 |
|         850 |              61 |
|         852 |              86 |
|         853 |              60 |
|         856 |              76 |
|         858 |              60 |
|         860 |              73 |
|         861 |              87 |
|         862 |             100 |
|         863 |              84 |
|         867 |              69 |
|         869 |              83 |
|         871 |              66 |
|         874 |              77 |
|         875 |              65 |
|         878 |              65 |
|         879 |              89 |
|         880 |              76 |
|         881 |              75 |
|         882 |              61 |
|         885 |              91 |
|         886 |              99 |
|         889 |              77 |
|         890 |              84 |
|         893 |              64 |
|         895 |              60 |
|         896 |              69 |
|         898 |              91 |
|         899 |              70 |
|         901 |              98 |
|         902 |              68 |
|         905 |              99 |
|         906 |              68 |
|         909 |              99 |
|         912 |              74 |
|         915 |              67 |
|         918 |              64 |
|         920 |              82 |
|         921 |              81 |
|         923 |              60 |
|         925 |              78 |
|         926 |              88 |
|         927 |              63 |
|         928 |              78 |
|         930 |              94 |
|         931 |              78 |
|         934 |              84 |
|         937 |              84 |
|         939 |              97 |
|         940 |              89 |
|         943 |              91 |
|         944 |              63 |
|         945 |              97 |
|         949 |              90 |
|         953 |              71 |
|         955 |              74 |
|         956 |              75 |
|         957 |              99 |
|         960 |              99 |
|         962 |              72 |
|         963 |              64 |
|         964 |              63 |
|         969 |              67 |
|         971 |              66 |
|         972 |              67 |
|         973 |              61 |
|         974 |              75 |
|         975 |              90 |
|         977 |              90 |
|         981 |              98 |
|         983 |              62 |
|         985 |              78 |
|         986 |              80 |
|         987 |              96 |
|         989 |              84 |
|         991 |              63 |
|         992 |              97 |
|         993 |              99 |
|         994 |              90 |
|         995 |              68 |
|         996 |              80 |
|         997 |              91 |
|         999 |              90 |
|        1002 |              60 |
|        1004 |              68 |
|        1005 |              79 |
|        1006 |              94 |
|        1007 |              83 |
|        1008 |              62 |
|        1009 |              85 |
|        1014 |              69 |
|        1015 |              97 |
|        1019 |              70 |
|        1020 |              76 |
|        1021 |              95 |
|        1024 |              71 |
|        1025 |              66 |
|        1026 |              84 |
|        1027 |              95 |
|        1028 |              90 |
|        1031 |              89 |
|        1036 |              89 |
|        1039 |              74 |
|        1043 |              80 |
|        1044 |              76 |
|        1046 |              79 |
|        1049 |              77 |
|        1051 |              64 |
|        1054 |              70 |
|        1055 |              96 |
|        1057 |              64 |
|        1062 |              62 |
|        1063 |              75 |
|        1067 |              96 |
|        1069 |              94 |
|        1070 |              81 |
|        1071 |              75 |
|        1072 |              81 |
|        1073 |              92 |
|        1074 |              96 |
|        1075 |              71 |
|        1077 |              72 |
|        1083 |              85 |
|        1084 |              97 |
|        1086 |              85 |
|        1087 |              62 |
|        1088 |              71 |
|        1090 |              61 |
|        1092 |              80 |
|        1099 |              98 |
|        1100 |              73 |
|        1102 |              76 |
|        1103 |              83 |
|        1106 |              83 |
|        1107 |              96 |
|        1108 |              62 |
|        1110 |              97 |
|        1111 |              61 |
|        1112 |              66 |
|        1113 |              67 |
|        1114 |              80 |
|        1117 |              96 |
|        1118 |              77 |
|        1119 |              65 |
|        1121 |              84 |
|        1123 |              62 |
|        1124 |              67 |
|        1126 |              90 |
|        1130 |              65 |
|        1132 |              73 |
|        1133 |              98 |
|        1135 |              81 |
|        1136 |              90 |
|        1137 |              83 |
|        1138 |              91 |
|        1143 |              76 |
|        1146 |              89 |
|        1149 |              66 |
|        1152 |              86 |
|        1155 |              82 |
|        1158 |              66 |
|        1159 |              89 |
|        1163 |              92 |
|        1165 |              96 |
|        1166 |              64 |
|        1168 |              83 |
|        1169 |              91 |
|        1170 |              94 |
|        1171 |              62 |
|        1173 |              68 |
|        1174 |              76 |
|        1176 |              81 |
|        1177 |              83 |
|        1182 |              96 |
|        1185 |              73 |
|        1186 |              64 |
|        1187 |              68 |
|        1188 |              89 |
|        1190 |              97 |
|        1192 |              70 |
|        1196 |              95 |
|        1197 |              88 |
|        1198 |              92 |
|        1200 |              89 |
|        1202 |              61 |
|        1204 |              82 |
|        1205 |              94 |
|        1206 |              99 |
|        1208 |              90 |
|        1209 |             100 |
|        1210 |              62 |
|        1211 |              78 |
|        1212 |              94 |
|        1213 |              74 |
|        1215 |              81 |
|        1218 |              63 |
|        1219 |              79 |
|        1221 |              64 |
|        1222 |              69 |
|        1223 |              69 |
|        1226 |              97 |
|        1227 |              91 |
|        1231 |              80 |
|        1232 |              79 |
|        1234 |              73 |
|        1235 |              99 |
|        1237 |              68 |
|        1238 |              92 |
|        1239 |              77 |
|        1241 |              79 |
|        1245 |              76 |
|        1247 |              60 |
|        1248 |              99 |
|        1252 |              86 |
|        1256 |              68 |
|        1258 |              67 |
|        1259 |              87 |
|        1260 |              64 |
|        1261 |              93 |
|        1263 |              62 |
|        1264 |              70 |
|        1265 |              92 |
|        1266 |              79 |
|        1268 |              83 |
|        1269 |              88 |
|        1271 |              98 |
|        1273 |              80 |
|        1275 |              73 |
|        1277 |              68 |
|        1278 |              97 |
|        1279 |              98 |
|        1281 |              78 |
|        1282 |              81 |
|        1283 |              68 |
|        1284 |              94 |
|        1285 |              93 |
|        1286 |              99 |
|        1289 |              93 |
|        1292 |              68 |
|        1293 |              61 |
|        1294 |              74 |
|        1295 |              64 |
|        1296 |              60 |
|        1298 |              85 |
|        1299 |              81 |
|        1301 |             100 |
|        1305 |              63 |
|        1312 |              87 |
|        1313 |              79 |
|        1315 |              67 |
|        1316 |              75 |
|        1319 |              93 |
|        1322 |              84 |
|        1323 |              74 |
|        1324 |              62 |
|        1325 |              77 |
|        1326 |              73 |
|        1329 |              97 |
|        1330 |              63 |
|        1331 |              65 |
|        1332 |              91 |
|        1333 |              60 |
|        1334 |              69 |
|        1337 |              85 |
|        1338 |              86 |
|        1341 |              72 |
|        1347 |              91 |
|        1348 |              95 |
|        1351 |              71 |
|        1353 |              89 |
|        1354 |              83 |
|        1356 |              91 |
|        1357 |              61 |
|        1358 |              66 |
|        1360 |              68 |
|        1364 |              90 |
|        1365 |              75 |
|        1366 |              69 |
|        1368 |              63 |
|        1370 |              75 |
|        1371 |              67 |
|        1372 |              64 |
|        1373 |              61 |
|        1375 |              97 |
|        1377 |              65 |
|        1380 |              64 |
|        1382 |              86 |
|        1385 |              96 |
|        1386 |              64 |
|        1388 |              85 |
|        1390 |              72 |
|        1398 |              67 |
|        1400 |              81 |
|        1406 |             100 |
|        1408 |              61 |
|        1411 |              93 |
|        1413 |             100 |
|        1414 |              79 |
|        1416 |              90 |
|        1419 |              75 |
|        1420 |              75 |
|        1422 |             100 |
|        1424 |              60 |
|        1428 |              90 |
|        1429 |              97 |
|        1432 |              88 |
|        1434 |              60 |
|        1435 |              64 |
|        1436 |              95 |
|        1437 |              83 |
|        1438 |              97 |
|        1441 |              76 |
|        1443 |              92 |
|        1449 |              95 |
|        1454 |              93 |
|        1456 |              79 |
|        1457 |             100 |
|        1461 |              85 |
|        1462 |              95 |
|        1463 |              90 |
|        1465 |              92 |
|        1466 |              72 |
|        1467 |              71 |
|        1470 |              98 |
|        1472 |              71 |
|        1474 |              63 |
|        1475 |              72 |
|        1476 |              61 |
|        1480 |             100 |
|        1481 |              74 |
|        1483 |              67 |
|        1484 |              61 |
|        1487 |              73 |
|        1495 |              76 |
|        1497 |              98 |
|        1500 |              85 |
|        1501 |              69 |
|        1503 |              66 |
|        1505 |              80 |
|        1508 |              86 |
|        1509 |              84 |
|        1512 |              91 |
|        1515 |              90 |
|        1516 |              93 |
|        1517 |              68 |
|        1519 |              73 |
|        1520 |              73 |
|        1521 |              66 |
|        1523 |              72 |
|        1524 |              88 |
|        1525 |              76 |
|        1528 |              75 |
|        1529 |              75 |
|        1530 |              63 |
|        1532 |              83 |
|        1535 |              66 |
|        1536 |              74 |
|        1537 |              82 |
|        1538 |              89 |
|        1539 |              65 |
|        1541 |              95 |
|        1542 |              77 |
|        1544 |              89 |
|        1559 |              75 |
|        1560 |              94 |
|        1561 |              84 |
|        1563 |              75 |
|        1566 |              93 |
|        1567 |              99 |
|        1569 |              76 |
|        1570 |              63 |
|        1572 |              88 |
|        1573 |              92 |
|        1577 |              75 |
|        1579 |              97 |
|        1580 |              80 |
|        1581 |              71 |
|        1582 |              77 |
|        1584 |              92 |
|        1585 |              95 |
|        1587 |              77 |
|        1588 |              99 |
|        1590 |              72 |
|        1591 |              80 |
|        1592 |             100 |
|        1593 |              83 |
|        1594 |              95 |
|        1599 |              85 |
|        1604 |              98 |
|        1605 |              92 |
|        1608 |              72 |
|        1610 |              93 |
|        1613 |              68 |
|        1616 |              62 |
|        1618 |              64 |
|        1619 |              72 |
|        1620 |              78 |
|        1629 |              64 |
|        1630 |              88 |
|        1634 |              80 |
|        1640 |              65 |
|        1643 |              70 |
|        1644 |              77 |
|        1645 |              90 |
|        1647 |              77 |
|        1648 |              78 |
|        1649 |              69 |
|        1650 |              63 |
|        1652 |              80 |
|        1654 |              93 |
|        1656 |              81 |
|        1659 |              66 |
|        1662 |              86 |
|        1667 |              64 |
|        1671 |              73 |
|        1673 |              73 |
|        1674 |              62 |
|        1676 |              90 |
+-------------+-----------------+


 -- Q3. Which are the top 5 products with the highest average review rating?
     > SELECT item_purchased,
    ->        ROUND(AVG(review_rating),2) AS average_product_rating
    -> FROM customer
    -> GROUP BY item_purchased
    -> ORDER BY AVG(review_rating) DESC
    -> LIMIT 5;
+----------------+------------------------+
| item_purchased | average_product_rating |
+----------------+------------------------+
| Gloves         |                   3.86 |
| Sandals        |                   3.84 |
| Boots          |                   3.82 |
| Hat            |                   3.80 |
| Skirt          |                   3.79 |
+----------------+------------------------+
 
  --Q4. Compare the average Purchase Amounts between Standard and Express Shipping.
       select shipping_type,
    -> ROUND(AVG(purchase_amount),2)
    -> from customer
    -> where shipping_type in ('Standard','Express')
    -> group by shipping_type;
+---------------+-------------------------------+
| shipping_type | ROUND(AVG(purchase_amount),2) |
+---------------+-------------------------------+
| Express       |                         60.48 |
| Standard      |                         58.46 |
+---------------+-------------------------------+


--Q5. Do subscribed customers spend more? Compare average spend and total revenue between subscribers and non-subscribers.
         SELECT subscription_status,
    ->        COUNT(customer_id) AS total_customers,
    ->        ROUND(AVG(purchase_amount),2) AS avg_spend,
    ->        ROUND(SUM(purchase_amount),2) AS total_revenue
    -> FROM customer
    -> GROUP BY subscription_status
    -> ORDER BY total_revenue,avg_spend DESC;
+---------------------+-----------------+-----------+---------------+
| subscription_status | total_customers | avg_spend | total_revenue |
+---------------------+-----------------+-----------+---------------+
| Yes                 |            1053 |     59.49 |      62645.00 |
| No                  |            2847 |     59.87 |     170436.00 |
+---------------------+-----------------+-----------+---------------+


 --Q6. Which 5 products have the highest percentage of purchases with discounts applied?
        SELECT item_purchased,
    ->        ROUND(100.0 * SUM(CASE WHEN discount_applied = 'Yes' THEN 1 ELSE 0 END)/COUNT(*),2) AS discount_rate
    -> FROM customer
    -> GROUP BY item_purchased
    -> ORDER BY discount_rate DESC
    -> LIMIT 5;
+----------------+---------------+
| item_purchased | discount_rate |
+----------------+---------------+
| Hat            |         50.00 |
| Sneakers       |         49.66 |
| Coat           |         49.07 |
| Sweater        |         48.17 |
| Pants          |         47.37 |
+----------------+---------------+



 --Q7. Segment customers into New, Returning, and Loyal based on their total number of previous purchases, and show the count of each segment.
       with customer_type as (
    -> SELECT customer_id, previous_purchases,
    -> CASE
    ->     WHEN previous_purchases = 1 THEN 'New'
    ->     WHEN previous_purchases BETWEEN 2 AND 10 THEN 'Returning'
    ->     ELSE 'Loyal'
    ->     END AS customer_segment
    -> FROM customer)
    ->
    -> select customer_segment,count(*) AS "Number of Customers"
    -> from customer_type
    -> group by customer_segment;
+------------------+---------------------+
| customer_segment | Number of Customers |
+------------------+---------------------+
| Loyal            |                3116 |
| New              |                  83 |
| Returning        |                 701 |
+------------------+---------------------+


 --Q8. What are the top 3 most purchased products within each category?
          WITH item_counts AS (
    ->     SELECT category,
    ->            item_purchased,
    ->            COUNT(customer_id) AS total_orders,
    ->            ROW_NUMBER() OVER (PARTITION BY category ORDER BY COUNT(customer_id) DESC) AS item_rank
    ->     FROM customer
    ->     GROUP BY category, item_purchased
    -> )
    -> SELECT item_rank,category, item_purchased, total_orders
    -> FROM item_counts
    -> WHERE item_rank <=3;
+-----------+-------------+----------------+--------------+
| item_rank | category    | item_purchased | total_orders |
+-----------+-------------+----------------+--------------+
|         3 | Accessories | Belt           |          161 |
|         1 | Accessories | Jewelry        |          171 |
|         2 | Accessories | Sunglasses     |          161 |
|         1 | Clothing    | Blouse         |          171 |
|         2 | Clothing    | Pants          |          171 |
|         3 | Clothing    | Shirt          |          169 |
|         1 | Footwear    | Sandals        |          160 |
|         2 | Footwear    | Shoes          |          150 |
|         3 | Footwear    | Sneakers       |          145 |
|         2 | Outerwear   | Coat           |          161 |
|         1 | Outerwear   | Jacket         |          163 |
+-----------+-------------+----------------+--------------+


 --Q9. Are customers who are repeat buyers (more than 5 previous purchases) also likely to subscribe?
         SELECT subscription_status,
    ->        COUNT(customer_id) AS repeat_buyers
    -> FROM customer
    -> WHERE previous_purchases > 5
    -> GROUP BY subscription_status;
+---------------------+---------------+
| subscription_status | repeat_buyers |
+---------------------+---------------+
| No                  |          2518 |
| Yes                 |           958 |
+---------------------+---------------+
 
  --Q10. What is the revenue contribution of each age group?
            SELECT
    ->     age_group,
    ->     SUM(purchase_amount) AS total_revenue
    -> FROM customer
    -> GROUP BY age_group
    -> ORDER BY total_revenue desc;
+-------------+---------------+
| age_group   | total_revenue |
+-------------+---------------+
| Young Adult |         62143 |
| Middle-aged |         59197 |
| Adult       |         55978 |
| Senior      |         55763 |
+-------------+---------------+
